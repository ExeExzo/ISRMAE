<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.0/dist/chart.min.js"></script>
    <title>ISMTO</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css">
    {% load static %}
    <link rel="stylesheet" href="{% static '\main\css\style.css' %}">
    <style>
    /* CROSS BROWSER SELECTOR*/
    .custom-progress {
          /* RESETS */
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
          border: none;
 
          width: 120px;
          height: 20px;
          border-radius: 20px;
          background-color: #777;
      }
 
      /* WEBKIT BROWSERS - CHROME, OPERA AND SAFARI */
      .custom-progress::-webkit-progress-bar {
          background-color: #777;
          border-radius: 20px;
      }
 
      .custom-progress::-webkit-progress-value {
          /* background-image:
              -webkit-linear-gradient(45deg, transparent 40%, rgba(0, 0, 0, .1) 40%, rgba(0, 0, 0, .1) 70%, transparent 70%),
              -webkit-linear-gradient(top, rgba(255, 255, 255, .25), rgba(0, 0, 0, .25)),
              -webkit-linear-gradient(left, #13f10f, #ff0000); */
              background: rgb(47, 213, 47);
          border-radius: 20px;
      }

      .custom-progressRed::-webkit-progress-value {
          /* background-image:
              -webkit-linear-gradient(45deg, transparent 40%, rgba(0, 0, 0, .1) 40%, rgba(0, 0, 0, .1) 70%, transparent 70%),
              -webkit-linear-gradient(top, rgba(255, 255, 255, .25), rgba(0, 0, 0, .25)),
              -webkit-linear-gradient(left, #13f10f, #ff0000); */
              background: rgb(253, 23, 23) !important;
          border-radius: 20px;
      }
      .custom-progressYellow::-webkit-progress-value {
          /* background-image:
              -webkit-linear-gradient(45deg, transparent 40%, rgba(0, 0, 0, .1) 40%, rgba(0, 0, 0, .1) 70%, transparent 70%),
              -webkit-linear-gradient(top, rgba(255, 255, 255, .25), rgba(0, 0, 0, .25)),
              -webkit-linear-gradient(left, #13f10f, #ff0000); */
              background: rgb(255, 123, 0) !important;
          border-radius: 20px;
      }
 
      /* MOZILLA FIREFOX */
      .custom-progress::-moz-progress-bar {
          /* background-image:
              -moz-linear-gradient(45deg, transparent 33%, rgba(0, 0, 0, 0.1) 40%, rgba(0, 0, 0, 0.1) 70%, transparent 70%),
              -moz-linear-gradient(top, rgba(255, 255, 255, 0.25), rgba(0, 0, 0, 0.25)),
              -moz-linear-gradient(left, #13f10f, #ff0000); */
          border-radius: 20px;
      }
 
      /* MICROSOFT EDGE & IE */
      .custom-progress::-ms-fill {
          border-radius: 18px;
          /* background: repeating-linear-gradient(45deg,
          #13f10f,
          #13f10f 10px,
          #ff0000 10px,
          #ff0000 20px); */
      }
      .filter{
        margin-left: 10px;
        padding: 15px; 
        background-color: rgb(21, 21, 146);
        color: white;
        border-radius: 5px;
      }
  </style>
  <style>
    .wrapper {
        width: 70%;
        margin: 0 auto;
        text-align: center;
    }

    .downloadBtn {
      margin-top: 30px;
      margin-left: 10px;
      float: right;
    }
</style>
</head>
<body>
  
      <header class="d-flex justify-content-center py-3 heade">
        <svg class="bi me-2" width="80" height="32"><use xlink:href="#bootstrap"></use></svg>

        <a  class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Coat_of_arms_military-of-kazakhstan.svg/1200px-Coat_of_arms_military-of-kazakhstan.svg.png" alt="" style="height: 70px; margin-right: 15px;">
            <p class="text-warning" >Информационная система <br>учета состояния военной автомобильной техники</p>
          </a>


          <a href="/main/" class="bar">Главная</a>
          <a href="/statistics/" class="bar">Аналитика</a>
          <a href="{% url 'admin:index' %}" class="bar">Объект АТ</a>
          <span class="bar">Имя: {{request.user}}</span>
          <span class="bar"><a href="{% url 'logout' %}" class="bar">Logout</a></span>


          <!-- <button type="button" class="btn bar">АТТ</button>
          <button type="button" class="btn bar">Обьекты ВВТ</button>
          <button type="button" class="btn bar">Справочник</button>
          <button type="button" class="btn bar">Отчеты</button> -->


        <svg class="bi me-2" width="80" height="32"><use xlink:href="#bootstrap"></use></svg>
      </header>
      <h3 class="zagoltrans">Национальный университет обороны имени Первого Президента РК - Елбасы</h3>
      <div class="container">
        <form action="" method="get" class="filter">
            {{myFilter.form}}

          <button class="btn btn-primary" type="submit">Найти</button>
        </form>

        <div class="downloadBtn">
          <button onclick="ExportData3()" class="btn btn-primary">Скачать список Шин</button>
        </div>
        <div class="downloadBtn">
          <button onclick="ExportData2()" class="btn btn-primary">Скачать список АКБ</button>
        </div>
        <div class="downloadBtn">
          <button onclick="ExportData()" class="btn btn-primary">Скачать регистрационный список</button>
        </div>
        <div class="downloadBtn">
          <button onclick="ExportData1()" class="btn btn-primary">Скачать полный отчет</button>
        </div>
      </div>
      <script>
        let myData = [];
        let myData1 = [];
        let myData2 = [];
        let myData3 = [];
      </script>

      


      <div class="container" id="myTable1" style="overflow-x: scroll; overflow-y: hidden; width: 1300px; border-width: 3px; border-color: #cfcfcf;">
        <div class="row mt-4">
            <div class="col" >
                <table class="table table-hover" >
                    <thead class="thead-dark">
                        <tr>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>#</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Подчиненность</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Род войск</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Город</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>№ воинской части</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Подразделение</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Основание постановки машины на учет</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Марка автомобиля</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Военный регистрационный номерной знак</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>до ТО № 1</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>до ТО № 2</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>до ТР</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>до СР</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>до КР</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Осталось до списания</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Паспортные данные</p></th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for Main in cars %}
                        <tr>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.field_p_p }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.rgk }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.rod_voiska }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.gorod }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.field_voinsnkoi_chasti }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.podrazdelenia }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.osnov_postanovki_tech_na_uchet }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.marka_avto }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ Main.voenni_reg_nomer }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p><progress id="custom-bar1_{{ Main.field_p_p }}" class="custom-progress" max="{{ Main.motoresurs_to_1 }}" value="{{ Main.mileage_from_beginning }}"></progress></p> <p>TO1 макс: {{ Main.motoresurs_to_1 }}</p> <button onclick="location.href='../changeTO1/' + {{ Main.field_p_p }}" id="stat-btn" class="btn">Добавить</button> </td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p><progress id="custom-bar2_{{ Main.field_p_p }}" class="custom-progress" max="{{ Main.motoresurs_to_2 }}" value="{{ Main.mileage_from_beginning }}"></progress></p> <p>TO2 макс: {{ Main.motoresurs_to_2 }}</p> <button onclick="location.href='../changeTO2/' + {{ Main.field_p_p }}" id="stat-btn" class="btn">Добавить</button> </td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p><progress id="custom-bar3_{{ Main.field_p_p }}" class="custom-progress" max="{{ Main.ostalos_motoresurs_tp }}" value="{{ Main.mileage_from_beginning }}"></progress></p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p><progress id="custom-bar4_{{ Main.field_p_p }}" class="custom-progress" max="{{ Main.ostalos_motoresurs_cp }}" value="{{ Main.mileage_from_beginning }}"></progress></p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p><progress id="custom-bar5_{{ Main.field_p_p }}" class="custom-progress" max="{{ Main.ostalos_motoresurs_kp }}" value="{{ Main.mileage_from_beginning }}"></progress></p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p><progress id="custom-bar6_{{ Main.field_p_p }}" class="custom-progress" max="{{ Main.ostalos_motoresurs_spisanie }}" value="{{ Main.mileage_from_beginning }}"></progress></p></td>
                          <script>

                          

                            function changeColor(id) {
                              var progress = document.getElementById(id);
                              if (progress.value / progress.max > 0.7) {
                                progress.classList.add("custom-progressRed");
                              }
                              if (progress.value / progress.max >= 0.4 && progress.value / progress.max <= 0.7) {
                                progress.classList.add("custom-progressYellow");
                              }
                            }

                            changeColor("custom-bar1_{{ Main.field_p_p }}");
                            changeColor("custom-bar2_{{ Main.field_p_p }}");
                            changeColor("custom-bar3_{{ Main.field_p_p }}");
                            changeColor("custom-bar4_{{ Main.field_p_p }}");
                            changeColor("custom-bar5_{{ Main.field_p_p }}");
                            changeColor("custom-bar6_{{ Main.field_p_p }}");
                            
                            console.log("{{Main}}")
                            myData.push({
                              "№ p/p": "{{ Main.field_p_p }}",
                              "Подчиненность": "{{ Main.rgk }}",
                              "Род войск": "{{ Main.rod_voiska }}",
                              "Город": "{{ Main.gorod }}",
                              "№ воинской части": "{{ Main.field_voinsnkoi_chasti }}",
                              "Подразделение": "{{ Main.podrazdelenia }}",
                              // "Основание постановки машины на учет": "{{ Main.osnov_postanovki_tech_na_uchet }}",
                              "Марка автомобиля": "{{ Main.marka_avto }}",
                              "Военный номерной регистрационный знак": "{{ Main.voenni_reg_nomer }}",
                              "Тип": "{{ Main.type }}",
                              "Вид": "{{ Main.vid}}",
                              "Группа эксплуатации": "{{ Main.gruppa_ekspluatacii }}",
                              "№  Шасси": "{{ Main.field_shassi }}",
                              "№ двигателя": "{{ Main.field_dvigatelia }}",
                              "№ кабины": "{{ Main.field_kabini }}",
                              "Год выпуска": "{{ Main.god_vipuska }}",
                              "Серия и номер паспорта": "{{ Main.seria_nomer_pasporta }}",
                              "Цвет": "{{ Main.color }}",
                              "Номер свидетельства о регистрации": "{{ Main.nomer_svedit_o_reg }}",
                              "Категория": "{{ Main.category }}",
                              // "Январь 2020": "{{ Main.january_2020 }}",
                              // "Февраль 2020": "{{ Main.february_2020 }}",
                              // "Март 2020": "{{ Main.march_2020 }}",
                              // "Апрель 2020": "{{ Main.april_2020 }}",
                              // "Май 2020": "{{ Main.may_2020 }}",
                              // "Июнь 2020": "{{ Main.june_2020 }}",
                              // "Июль 2020": "{{ Main.july_2020 }}",
                              // "Август 2020": "{{ Main.august_2020 }}",
                              // "Сентябрь 2020": "{{ Main.september_2020 }}",
                              // "Октябрь 2020": "{{ Main.october_2020 }}",
                              // "Ноябрь 2020": "{{ Main.november_2020 }}",
                              // "Декабрь 2020": "{{ Main.december_2020 }}",
                              // "Январь 2021": "{{ Main.january_2021 }}",
                              // "Февраль 2021": "{{ Main.february_2021 }}",
                              // "Март 2021": "{{ Main.march_2021 }}",
                              // "Апрель 2021": "{{ Main.april_2021 }}",
                              // "Май 2021": "{{ Main.may_2021 }}",
                              // "Июнь 2021": "{{ Main.june_2021 }}",
                              // "Июль 2021": "{{ Main.july_2021 }}",
                              // "Август 2021": "{{ Main.august_2021 }}",
                              // "Сентябрь 2021": "{{ Main.september_2021 }}",
                              // "Октябрь 2021": "{{ Main.october_2021 }}",
                              // "Ноябрь 2021": "{{ Main.november_2021 }}",
                              // "Декабрь 2021": "{{ Main.december_2021 }}",
                              "Выделено моторесурсов на год": "{{ Main.videleno_motoresurs_na_year }}",
                              // "Январь 2022": "{{ Main.january_2022 }}",
                              // "Февраль 2022": "{{ Main.february_2022 }}",
                              // "Март 2022": "{{ Main.march_2022 }}",
                              // "Апрель 2022": "{{ Main.april_2022 }}",
                              // "Май 2022": "{{ Main.may_2022 }}",
                              // "Июнь 2022": "{{ Main.june_2022 }}",
                              // "Июль 2022": "{{ Main.july_2022 }}",
                              // "Август 2022": "{{ Main.august_2022 }}",
                              // "Сентябрь 2022": "{{ Main.september_2022 }}",
                              // "Октябрь 2022": "{{ Main.october_2022 }}",
                              // "Ноябрь 2022": "{{ Main.november_2022 }}",
                              // "Декабрь 2022": "{{ Main.december_2022 }}",
                              "Израсходовано моторесурсов с начало года": "{{ Main.izrashodovano_s_nachalo_year }}",
                              "Остаток моторесурсов до конца года": "{{ Main.ostatok_resursov_do_konca_year }}",
                              "Пробег с начала эксплуатации": "{{ Main.mileage_from_beginning }}",
                              // "Техническое состояние": "{{ Main.tech_sostoianie }}",
                              // "Вид и дата проведенного ремонта": "{{ Main.vid_and_data_remonta }}",
                              // "Примечание": "{{ Main.primechanie }}",
                              // "Осталось моторесурсов до ТО № 1": "{{ Main.motoresurs_to_1 }}",
                              // "Осталось моторесурсов до ТО № 2": "{{ Main.motoresurs_to_2 }}",
                              // "Осталось моторесурсов до ТР": "{{ Main.ostalos_motoresurs_tp }}",
                              // "Осталось моторесурсов до СР": "{{ Main.ostalos_motoresurs_cp }}",
                              // "Осталось моторесурсов до КР": "{{ Main.ostalos_motoresurs_kp }}",
                              // "Осталось моторесурсов до списания": "{{ Main.ostalos_motoresurs_spisanie }}",
                              // "Тип АКБ": "{{ Main.type_akb }}",
                              // "Количество АКБ": "{{ Main.kolichestvo_akb }}",
                              // "Кем выдано": "{{ Main.kev_vidano }}",
                              // "№ наряда и когда выдано": "{{ Main.field_nariad_kogda_vidano }}",
                              // "Срок службы АКБ": "{{ Main.srok_sluzhbi_akb }}",
                              // "Дата установки АКБ": "{{ Main.data_ustanovki_akb }}",
                              // "Дата списания АКБ по годам": "{{ Main.data_spisania_akb_po_godam }}",
                              // "Срок службы в км. до списания АКБ": "{{ Main.srok_sluzhbi_akb_v_km_do_spisania }}",
                              // "Январь АКБ": "{{ Main.akb_january }}",
                              // "Февраль АКБ": "{{ Main.akb_february }}",
                              // "Март АКБ": "{{ Main.akb_march }}",
                              // "Апрель АКБ": "{{ Main.akb_april }}",
                              // "Май АКБ": "{{ Main.akb_may }}",
                              // "Июль АКБ": "{{ Main.akb_june }}",
                              // "Июнь АКБ": "{{ Main.akb_july }}",
                              // "Август АКБ": "{{ Main.akb_august }}",
                              // "Сентябрь АКБ": "{{ Main.akb_september }}",
                              // "Октябрь АКБ": "{{ Main.akb_october }}",
                              // "Ноябрь АКБ": "{{ Main.akb_november }}",
                              // "Декабрь АКБ": "{{ Main.akb_december }}",
                              // "Пройдено км с момента установки АКБ": "{{ Main.proideno_km_from_beginning_akb }}",
                              // "Осталось км. до списания": "{{ Main.akb_ostalos_km_do_spisania }}",
                            })
                            
                            console.log("{{Main}}")
                            myData1.push({
                              "№ p/p": "{{ Main.field_p_p }}",
                              "Подчиненность": "{{ Main.rgk }}",
                              "Род войск": "{{ Main.rod_voiska }}",
                              "Город": "{{ Main.gorod }}",
                              "№ воинской части": "{{ Main.field_voinsnkoi_chasti }}",
                              "Подразделение": "{{ Main.podrazdelenia }}",
                              "Основание постановки машины на учет": "{{ Main.osnov_postanovki_tech_na_uchet }}",
                              "Марка автомобиля": "{{ Main.marka_avto }}",
                              "Военный номерной регистрационный знак": "{{ Main.voenni_reg_nomer }}",
                              "Тип": "{{ Main.type }}",
                              "Вид": "{{ Main.vid}}",
                              "Группа эксплуатации": "{{ Main.gruppa_ekspluatacii }}",
                              "№  Шасси": "{{ Main.field_shassi }}",
                              "№ двигателя": "{{ Main.field_dvigatelia }}",
                              "№ кабины": "{{ Main.field_kabini }}",
                              "Год выпуска": "{{ Main.god_vipuska }}",
                              "Серия и номер паспорта": "{{ Main.seria_nomer_pasporta }}",
                              "Цвет": "{{ Main.color }}",
                              "Номер свидетельства о регистрации": "{{ Main.nomer_svedit_o_reg }}",
                              "Категория": "{{ Main.category }}",
                              "Январь 2020": "{{ Main.january_2020 }}",
                              "Февраль 2020": "{{ Main.february_2020 }}",
                              "Март 2020": "{{ Main.march_2020 }}",
                              "Апрель 2020": "{{ Main.april_2020 }}",
                              "Май 2020": "{{ Main.may_2020 }}",
                              "Июнь 2020": "{{ Main.june_2020 }}",
                              "Июль 2020": "{{ Main.july_2020 }}",
                              "Август 2020": "{{ Main.august_2020 }}",
                              "Сентябрь 2020": "{{ Main.september_2020 }}",
                              "Октябрь 2020": "{{ Main.october_2020 }}",
                              "Ноябрь 2020": "{{ Main.november_2020 }}",
                              "Декабрь 2020": "{{ Main.december_2020 }}",
                              "Январь 2021": "{{ Main.january_2021 }}",
                              "Февраль 2021": "{{ Main.february_2021 }}",
                              "Март 2021": "{{ Main.march_2021 }}",
                              "Апрель 2021": "{{ Main.april_2021 }}",
                              "Май 2021": "{{ Main.may_2021 }}",
                              "Июнь 2021": "{{ Main.june_2021 }}",
                              "Июль 2021": "{{ Main.july_2021 }}",
                              "Август 2021": "{{ Main.august_2021 }}",
                              "Сентябрь 2021": "{{ Main.september_2021 }}",
                              "Октябрь 2021": "{{ Main.october_2021 }}",
                              "Ноябрь 2021": "{{ Main.november_2021 }}",
                              "Декабрь 2021": "{{ Main.december_2021 }}",
                              "Показания спидометра на 1.01.2022": "{{ Main.speedometer_01_01_2022 }}",
                              "Выделено моторесурсов на год": "{{ Main.videleno_motoresurs_na_year }}",
                              "Январь 2022": "{{ Main.january_2022 }}",
                              "Февраль 2022": "{{ Main.february_2022 }}",
                              "Март 2022": "{{ Main.march_2022 }}",
                              "Апрель 2022": "{{ Main.april_2022 }}",
                              "Май 2022": "{{ Main.may_2022 }}",
                              "Июнь 2022": "{{ Main.june_2022 }}",
                              "Июль 2022": "{{ Main.july_2022 }}",
                              "Август 2022": "{{ Main.august_2022 }}",
                              "Сентябрь 2022": "{{ Main.september_2022 }}",
                              "Октябрь 2022": "{{ Main.october_2022 }}",
                              "Ноябрь 2022": "{{ Main.november_2022 }}",
                              "Декабрь 2022": "{{ Main.december_2022 }}",
                              "Январь 2023": "{{ Main.january_2023 }}",
                              "Февраль 2023": "{{ Main.february_2023 }}",
                              "Март 2023": "{{ Main.march_2023 }}",
                              "Апрель 2023": "{{ Main.april_2023 }}",
                              "Май 2023": "{{ Main.may_2023 }}",
                              "Июнь 2023": "{{ Main.june_2023 }}",
                              "Июль 2023": "{{ Main.july_2023 }}",
                              "Август 2023": "{{ Main.august_2023 }}",
                              "Сентябрь 2023": "{{ Main.september_2023 }}",
                              "Октябрь 2023": "{{ Main.october_2023 }}",
                              "Ноябрь 2023": "{{ Main.november_2023 }}",
                              "Декабрь 2023": "{{ Main.december_2023 }}",
                              "Израсходовано моторесурсов с начало года": "{{ Main.izrashodovano_s_nachalo_year }}",
                              "Остаток моторесурсов до конца года": "{{ Main.ostatok_resursov_do_konca_year }}",
                              "Пробег с начала эксплуатации": "{{ Main.mileage_from_beginning }}",
                              "Техническое состояние": "{{ Main.tech_sostoianie }}",
                              "Вид и дата проведенного ремонта": "{{ Main.vid_and_data_remonta }}",
                              "Примечание": "{{ Main.primechanie }}",
                              "Осталось моторесурсов до ТО № 1": "{{ Main.motoresurs_to_1 }}",
                              "Осталось моторесурсов до ТО № 2": "{{ Main.motoresurs_to_2 }}",
                              "Осталось моторесурсов до ТР": "{{ Main.ostalos_motoresurs_tp }}",
                              "Осталось моторесурсов до СР": "{{ Main.ostalos_motoresurs_cp }}",
                              "Осталось моторесурсов до КР": "{{ Main.ostalos_motoresurs_kp }}",
                              "Осталось моторесурсов до списания": "{{ Main.ostalos_motoresurs_spisanie }}",
                              "Тип АКБ": "{{ Main.type_akb }}",
                              "Количество АКБ": "{{ Main.kolichestvo_akb }}",
                              "Кем выдано": "{{ Main.kev_vidano }}",
                              "№ наряда и когда выдано": "{{ Main.field_nariad_kogda_vidano }}",
                              "Срок службы АКБ": "{{ Main.srok_sluzhbi_akb }}",
                              "Дата установки АКБ": "{{ Main.data_ustanovki_akb }}",
                              "Дата списания АКБ по годам": "{{ Main.data_spisania_akb_po_godam }}",
                              "Срок службы в км. до списания АКБ": "{{ Main.srok_sluzhbi_akb_v_km_do_spisania }}",
                              "Январь АКБ 2020": "{{ Main.akb_january_2020 }}",
                              "Февраль АКБ 2020": "{{ Main.akb_february_2020 }}",
                              "Март АКБ 2020": "{{ Main.akb_march_2020 }}",
                              "Апрель АКБ 2020": "{{ Main.akb_april_2020 }}",
                              "Май АКБ 2020": "{{ Main.akb_may_2020 }}",
                              "Июль АКБ 2020": "{{ Main.akb_june_2020 }}",
                              "Июнь АКБ 2020": "{{ Main.akb_july_2020 }}",
                              "Август АКБ 2020": "{{ Main.akb_august_2020 }}",
                              "Сентябрь АКБ 2020": "{{ Main.akb_september_2020 }}",
                              "Октябрь АКБ 2020": "{{ Main.akb_october_2020 }}",
                              "Ноябрь АКБ 2020": "{{ Main.akb_november_2020 }}",
                              "Декабрь АКБ 2020": "{{ Main.akb_december_2020 }}",
                              "Январь АКБ 2021": "{{ Main.akb_january_2021 }}",
                              "Февраль АКБ 2021": "{{ Main.akb_february_2021 }}",
                              "Март АКБ 2021": "{{ Main.akb_march_2021 }}",
                              "Апрель АКБ 2021": "{{ Main.akb_april_2021 }}",
                              "Май АКБ 2021": "{{ Main.akb_may_2021 }}",
                              "Июль АКБ 2021": "{{ Main.akb_june_2021 }}",
                              "Июнь АКБ 2021": "{{ Main.akb_july_2021 }}",
                              "Август АКБ 2021": "{{ Main.akb_august_2021 }}",
                              "Сентябрь АКБ 2021": "{{ Main.akb_september_2021 }}",
                              "Октябрь АКБ 2021": "{{ Main.akb_october_2021 }}",
                              "Ноябрь АКБ 2021": "{{ Main.akb_november_2021 }}",
                              "Декабрь АКБ 2021": "{{ Main.akb_december_2021 }}",
                              "Январь АКБ 2022": "{{ Main.akb_january_2022 }}",
                              "Февраль АКБ 2022": "{{ Main.akb_february_2022 }}",
                              "Март АКБ 2022": "{{ Main.akb_march_2022 }}",
                              "Апрель АКБ 2022": "{{ Main.akb_april_2022 }}",
                              "Май АКБ 2022": "{{ Main.akb_may_2022 }}",
                              "Июль АКБ 2022": "{{ Main.akb_june_2022 }}",
                              "Июнь АКБ 2022": "{{ Main.akb_july_2022 }}",
                              "Август АКБ 2022": "{{ Main.akb_august_2022 }}",
                              "Сентябрь АКБ 2022": "{{ Main.akb_september_2022 }}",
                              "Октябрь АКБ 2022": "{{ Main.akb_october_2022 }}",
                              "Ноябрь АКБ 2022": "{{ Main.akb_november_2022 }}",
                              "Декабрь АКБ 2022": "{{ Main.akb_december_2022 }}",
                              "Январь АКБ 2023": "{{ Main.akb_january_2023 }}",
                              "Февраль АКБ 2023": "{{ Main.akb_february_2023 }}",
                              "Март АКБ 2023": "{{ Main.akb_march_2023 }}",
                              "Апрель АКБ 2023": "{{ Main.akb_april_2023 }}",
                              "Май АКБ 2023": "{{ Main.akb_may_2023 }}",
                              "Июль АКБ 2023": "{{ Main.akb_june_2023 }}",
                              "Июнь АКБ 2023": "{{ Main.akb_july_2023 }}",
                              "Август АКБ 2023": "{{ Main.akb_august_2023 }}",
                              "Сентябрь АКБ 2023": "{{ Main.akb_september_2023 }}",
                              "Октябрь АКБ 2023": "{{ Main.akb_october_2023 }}",
                              "Ноябрь АКБ 2023": "{{ Main.akb_november_2023 }}",
                              "Декабрь АКБ 2023": "{{ Main.akb_december_2023 }}",
                              "Пройдено км с момента установки АКБ": "{{ Main.proideno_km_from_beginning_akb }}",
                              "Осталось км. до списания": "{{ Main.akb_ostalos_km_do_spisania }}",
                            })

                            console.log("{{Main}}")
                            myData2.push({
                              "Марка автомобиля": "{{ Main.marka_avto }}",
                              "Номер свидетельства о регистрации": "{{ Main.nomer_svedit_o_reg }}",
                              "Тип АКБ": "{{ Main.type_akb }}",
                              "Количество АКБ": "{{ Main.kolichestvo_akb }}",
                              "Кем выдано": "{{ Main.kev_vidano }}",
                              "№ наряда и когда выдано": "{{ Main.field_nariad_kogda_vidano }}",
                              "Срок службы АКБ": "{{ Main.srok_sluzhbi_akb }}",
                              "Дата установки АКБ": "{{ Main.data_ustanovki_akb }}",
                              "Дата списания АКБ по годам": "{{ Main.data_spisania_akb_po_godam }}",
                              "Срок службы в км. до списания АКБ": "{{ Main.srok_sluzhbi_akb_v_km_do_spisania }}",
                              "Пройдено км с момента установки АКБ": "{{ Main.proideno_km_from_beginning_akb }}",
                              "Осталось км. до списания": "{{ Main.akb_ostalos_km_do_spisania }}",
                            })
                          </script>
                          <td style="text-align: center; vertical-align: middle"><button onclick="location.href='../carDetails/' + {{ Main.field_p_p }}" style="border: 0px; border-radius: 5px; background-color: rgb(21, 21, 146); color: white; padding-top: 10px; padding-bottom: 10px;">Паспорт машины</button></td>
                        </tr>
                      </tbody>
                      {% endfor %}

                </table>
            </div>
        </div>
      </div>
      <br>
      

      <h3 class="zagoltrans">Перемещение АТ:</h3>
      <div class="container" style="overflow-x: scroll; overflow-y: hidden; width: 1320px; border-width: 3px; border-color: #cfcfcf;">
        <div class="row mt-4">
            <div class="col">
                <table class="table table-hover">
                    <thead class="thead-dark">
                        <tr>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>#</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Подчиненность</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Род войск</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Город</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>№ воинской части</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Подразделение</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Основание постановки машины на учет</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Марка автомобиля</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Военно регистрационный номер</p></th>
                          <th scope="col" class="th" style="background-color: rgb(21, 21, 146); border-color: white; border-width: 5px; border-radius: 15px;"><p>Паспортные данные</p></th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for spissannie in spissannie %}
                        <tr>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.field_p_p }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.rgk }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.rod_voiska }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.gorod }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.field_voinsnkoi_chasti }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.podrazdelenia }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.osnov_postanovki_tech_na_uchet }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.marka_avto }}</p></td>
                          <td class="td" style="background-color: rgb(230, 230, 230); border-radius: 8px; border-color: white; border-width: 5px; border-radius: 15px; text-align: center; vertical-align: middle"><p>{{ spissannie.voenni_reg_nomer }}</p></td>
                          <td style="text-align: center; vertical-align: middle"><button onclick="location.href='../carDetails/' + {{ spissannie.field_p_p }}" style="border: 0px; border-radius: 5px; background-color: rgb(21, 21, 146); color: white; padding-top: 10px; padding-bottom: 10px;">Паспорт машины</button></td>
                        </tr>
                      </tbody>
                      {% endfor %}
                      {% for shini in shini %}
                      <script>
                        console.log("{{shini}}")
                            myData3.push({
                              "ID Шин": "{{ shini.id_shin }}",
                              "Тип шины": "{{ shini.type_shin }}",
                              "ID Техники": "{{ shini.id_techniki }}",
                              "Размер шин": "{{ shini.razmer_shin }}",
                              "Количество шин": "{{ shini.kolichestvo_shin }}",
                              "Кем выдано": "{{ shini.kem_vidano }}",
                              "№ наряда и когда выданы шины": "{{ shini.field_nariad_kogda_vidano }}",
                              "Дата установки шин": "{{ shini.data_ustanovki_shini }}",
                              "Срок службы в км. до списания шин": "{{ shini.srok_sluzhbi_v_km }}",
                              "Январь_2020": "{{ shini.january_2020 }}",
                              "Февраль_2020": "{{ shini.february_2020 }}",
                              "Март_2020": "{{ shini.march_2020 }}",
                              "Апрель_2020": "{{ shini.april_2020 }}",
                              "Май_2020": "{{ shini.may_2020 }}",
                              "Июнь_2020": "{{ shini.june_2020 }}",
                              "Июль_2020": "{{ shini.july_2020 }}",
                              "Август_2020": "{{ shini.august_2020 }}",
                              "Сентябрь_2020": "{{ shini.september_2020 }}",
                              "Октябрь_2020": "{{ shini.october_2020 }}",
                              "Ноябрь_2020": "{{ shini.november_2020 }}",
                              "Декабрь_2020": "{{ shini.december_2020 }}",
                              "Январь_2021": "{{ shini.january_2021 }}",
                              "Февраль_2021": "{{ shini.february_2021 }}",
                              "Март_2021": "{{ shini.march_2021 }}",
                              "Апрель_2021": "{{ shini.april_2021 }}",
                              "Май_2021": "{{ shini.may_2021 }}",
                              "Июнь_2021": "{{ shini.june_2021 }}",
                              "Июль_2021": "{{ shini.july_2021 }}",
                              "Август_2021": "{{ shini.august_2021 }}",
                              "Сентябрь_2021": "{{ shini.september_2021 }}",
                              "Октябрь_2021": "{{ shini.october_2021 }}",
                              "Ноябрь_2021": "{{ shini.november_2021 }}",
                              "Декабрь_2021": "{{ shini.december_2021 }}",
                              "Январь_2022": "{{ shini.january_2022 }}",
                              "Февраль_2022": "{{ shini.february_2022 }}",
                              "Март_2022": "{{ shini.march_2022 }}",
                              "Апрель_2022": "{{ shini.april_2022 }}",
                              "Май_2022": "{{ shini.may_2022 }}",
                              "Июнь_2022": "{{ shini.june_2022 }}",
                              "Июль_2022": "{{ shini.july_2022 }}",
                              "Август_2022": "{{ shini.august_2022 }}",
                              "Сентябрь_2022": "{{ shini.september_2022 }}",
                              "Октябрь_2022": "{{ shini.october_2022 }}",
                              "Ноябрь_2022": "{{ shini.november_2022 }}",
                              "Декабрь_2022": "{{ shini.december_2022 }}",
                              "Январь_2023": "{{ shini.january_2023 }}",
                              "Февраль_2023": "{{ shini.february_2023 }}",
                              "Март_2023": "{{ shini.march_2023 }}",
                              "Апрель_2023": "{{ shini.april_2023 }}",
                              "Май_2023": "{{ shini.may_2023 }}",
                              "Июнь_2023": "{{ shini.june_2023 }}",
                              "Июль_2023": "{{ shini.july_2023 }}",
                              "Август_2023": "{{ shini.august_2023 }}",
                              "Сентябрь_2023": "{{ shini.september_2023 }}",
                              "Октябрь_2023": "{{ shini.october_2023 }}",
                              "Ноябрь_2023": "{{ shini.november_2023 }}",
                              "Декабрь_2023": "{{ shini.december_2023 }}",
                              "Пройдено километров с момента установки шин": "{{ shini.proideno_km_from_beginning }}",
                              "Пройдено км с момента установки с учетом запасного колеса": "{{ shini.proideno_km_from_beginning_uchetom_zapasnogo }}",
                              "Осталось километров до списания (с учетом запасного колеса)": "{{ shini.ostalos_km_do_spisania }}",
                            })
                      </script>
                      {% endfor %}
                </table>
            </div>
        </div>
      </div>

     


      <footer class="page-footer font-small blue vniz"> 

        
      
      </footer>

    <script type="text/javascript" src="//unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
      scrollReviews();
      function scrollReviews() {
      const ele = document.getElementById('myTable1');
      ele.style.cursor = 'grab';

      let pos = { top: 0, left: 0, x: 0, y: 0 };

      const mouseDownHandler = function (e) {
        ele.style.cursor = 'grabbing';
        ele.style.userSelect = 'none';

        pos = {
          left: ele.scrollLeft,
          top: ele.scrollTop,
          // Get the current mouse position
          x: e.clientX,
          y: e.clientY,
        };

        document.addEventListener('mousemove', mouseMoveHandler);
        document.addEventListener('mouseup', mouseUpHandler);
      };

      const mouseMoveHandler = function (e) {
        // How far the mouse has been moved
        const dx = e.clientX - pos.x;
        const dy = e.clientY - pos.y;

        // Scroll the element
        ele.scrollTop = pos.top - dy;
        ele.scrollLeft = pos.left - dx;
      };

      const mouseUpHandler = function () {
        ele.style.cursor = 'grab';
        ele.style.removeProperty('user-select');

        document.removeEventListener('mousemove', mouseMoveHandler);
        document.removeEventListener('mouseup', mouseUpHandler);
      };

      // Attach the handler
      ele.addEventListener('mousedown', mouseDownHandler);
    }

    console.log(myData);
    function ExportData() {
      var filename='pasport.xlsx';
      var data=myData
      var ws = XLSX.utils.json_to_sheet(data);
      var wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Report");
      XLSX.writeFile(wb,filename);
     }

    console.log(myData1);
    function ExportData1() {
      var filename='pasportall.xlsx';
      var data=myData1
      var ws = XLSX.utils.json_to_sheet(data);
      var wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Report");
      XLSX.writeFile(wb,filename);
     }

    console.log(myData2);
    function ExportData2() {
      var filename='pasportAKB.xlsx';
      var data=myData2
      var ws = XLSX.utils.json_to_sheet(data);
      var wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Report");
      XLSX.writeFile(wb,filename);
     }

    console.log(myData3);
    function ExportData3() {
      var filename='pasportShin.xlsx';
      var data=myData3
      var ws = XLSX.utils.json_to_sheet(data);
      var wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Report");
      XLSX.writeFile(wb,filename);
     }
     
    </script>
</body>
</html>